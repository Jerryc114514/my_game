<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Aim Trainer Game</title>
  <style>
    body {
      margin: 0;
      overflow: hidden;
      font-family: Arial, sans-serif;
      background-color: #000;
    }
    #score {
      position: absolute;
      top: 10px;
      left: 10px;
      color: white;
      font-size: 20px;
      z-index: 1;
      text-shadow: 1px 1px 2px black;
    }
    #timer {
      position: absolute;
      top: 10px;
      right: 10px;
      color: white;
      font-size: 20px;
      z-index: 1;
      text-shadow: 1px 1px 2px black;
    }
    #username {
      position: absolute;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      z-index: 2;
      background: rgba(0,0,0,0.7);
      padding: 20px;
      border-radius: 5px;
      color: white;
      text-align: center;
    }
    #username h1 {
      margin-top: 0;
      margin-bottom: 20px;
    }
    #username input {
      font-size: 16px;
      padding: 8px;
      margin-bottom: 15px;
      width: 100%;
      box-sizing: border-box;
    }
    #username button {
      font-size: 16px;
      padding: 8px 15px;
      background-color: #ff3333;
      color: white;
      border: none;
      border-radius: 4px;
      cursor: pointer;
      width: 100%;
    }
    #username button:hover {
      background-color: #ff5555;
    }
    #crosshair {
      position: absolute;
      left: 50%;
      top: 50%;
      transform: translate(-50%, -50%);
      width: 20px;
      height: 20px;
      border: 2px solid rgba(255, 255, 255, 0.7);
      border-radius: 50%;
      pointer-events: none;
      z-index: 1;
      display: none;
    }
  </style>
</head>
<body>
  <!-- Username input screen -->
  <div id="username">
    <h1>Aim Trainer Game</h1>
    <label for="user">Enter Username (optional): </label>
    <input type="text" id="user" placeholder="Your name">
    <button onclick="startGame()">Start Game</button>
  </div>
  
  <div id="score">Score: 0</div>
  <div id="timer">Time: 60</div>
  <div id="crosshair"></div>
  
  <!-- Load Three.js from CDN -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"></script>
  
  <script>
    // Game variables
    let scene, camera, renderer;
    let score = 0;
    let timeLeft = 60;
    let balloons = [];
    let scoreDiv = document.getElementById('score');
    let timerDiv = document.getElementById('timer');
    let usernameDiv = document.getElementById('username');
    let crosshair = document.getElementById('crosshair');
    let gameStarted = false;
    let username = "Player";
    let timerInterval;
    let raycaster, mouse;

    // Initialize Three.js scene
    function init() {
      // Create scene
      scene = new THREE.Scene();
      scene.background = new THREE.Color(0x87CEEB); // Sky blue background
      
      // Create camera
      camera = new THREE.PerspectiveCamera(
        75, window.innerWidth / window.innerHeight, 0.1, 1000
      );
      
      // Create renderer
      renderer = new THREE.WebGLRenderer({ antialias: true });
      renderer.setSize(window.innerWidth, window.innerHeight);
      document.body.appendChild(renderer.domElement);

      // Add lights
      const ambientLight = new THREE.AmbientLight(0xffffff, 0.6);
      scene.add(ambientLight);
      
      const directionalLight = new THREE.DirectionalLight(0xffffff, 0.8);
      directionalLight.position.set(10, 20, 10);
      scene.add(directionalLight);

      // Add floor
      const floorGeometry = new THREE.PlaneGeometry(100, 100);
      const floorMaterial = new THREE.MeshStandardMaterial({ 
        color: 0x444444,
        roughness: 0.7,
        metalness: 0.1
      });
      const floor = new THREE.Mesh(floorGeometry, floorMaterial);
      floor.rotation.x = -Math.PI / 2;
      floor.position.y = -2;
      scene.add(floor);

      // Set camera position (first-person perspective)
      camera.position.set(0, 1.6, 0);

      // Initialize raycaster for shooting
      raycaster = new THREE.Raycaster();
      mouse = new THREE.Vector2();

      // Handle window resize
      window.addEventListener('resize', () => {
        camera.aspect = window.innerWidth / window.innerHeight;
        camera.updateProjectionMatrix();
        renderer.setSize(window.innerWidth, window.innerHeight);
      });
    }

    // Start the game
    function startGame() {
      // Get username if provided
      const userInput = document.getElementById('user').value;
      if (userInput.trim() !== "") {
        username = userInput;
      }
      
      // Hide username input and show crosshair
      usernameDiv.style.display = 'none';
      crosshair.style.display = 'block';
      
      // Initialize game if not already started
      if (!gameStarted) {
        init();
        gameStarted = true;
        
        // Create initial balloons
        for (let i = 0; i < 5; i++) {
          createBalloon();
        }
        
        // Start animation loop
        animate();
        
        // Add click event listener for shooting
        window.addEventListener('click', shoot, false);
      } else {
        // Reset game state if restarting
        score = 0;
        timeLeft = 60;
        scoreDiv.textContent = 'Score: 0';
        timerDiv.textContent = 'Time: 60';
        
        // Clear existing balloons
        balloons.forEach(balloon => scene.remove(balloon));
        balloons = [];
        
        // Create new balloons
        for (let i = 0; i < 5; i++) {
          createBalloon();
        }
      }
      
      // Start timer
      if (timerInterval) {
        clearInterval(timerInterval);
      }
      
      timerInterval = setInterval(() => {
        if (timeLeft > 0) {
          timeLeft--;
          timerDiv.textContent = 'Time: ' + timeLeft;
        } else {
          endGame();
        }
      }, 1000);
    }

    // End the game
    function endGame() {
      clearInterval(timerInterval);
      alert(`Time's up, ${username}! Your score: ${score}`);
      
      // Reset for a new game
      usernameDiv.style.display = 'block';
      crosshair.style.display = 'none';
    }

    // Create a balloon
    function createBalloon() {
      const geometry = new THREE.SphereGeometry(0.5, 16, 16);
      const material = new THREE.MeshStandardMaterial({ 
        color: 0xff0000,
        roughness: 0.3,
        metalness: 0.2,
        emissive: 0x330000
      });
      const balloon = new THREE.Mesh(geometry, material);
      
      // Random position
      balloon.position.set(
        (Math.random() - 0.5) * 20,
        Math.random() * 5 - 2, // Start below ground level
        -Math.random() * 10 - 5
      );
      
      scene.add(balloon);
      balloons.push(balloon);
    }

    // Update balloon positions
    function updateBalloons() {
      for (let i = balloons.length - 1; i >= 0; i--) {
        let balloon = balloons[i];
        // Float upward
        balloon.position.y += 0.02;
        
        // If balloon goes too high, remove it and create a new one
        if (balloon.position.y > 10) {
          scene.remove(balloon);
          balloons.splice(i, 1);
          createBalloon();
        }
      }
    }

    // Handle shooting
    function shoot(event) {
      // Convert mouse position to normalized device coordinates
      mouse.x = (event.clientX / window.innerWidth) * 2 - 1;
      mouse.y = -(event.clientY / window.innerHeight) * 2 + 1;
      
      // Set up raycaster
      raycaster.setFromCamera(mouse, camera);
      
      // Check for intersections with balloons
      const intersects = raycaster.intersectObjects(balloons);
      if (intersects.length > 0) {
        // Hit a balloon
        const hitBalloon = intersects[0].object;
        scene.remove(hitBalloon);
        balloons.splice(balloons.indexOf(hitBalloon), 1);
        
        // Update score
        score++;
        scoreDiv.textContent = 'Score: ' + score;
        
        // Create a new balloon
        createBalloon();
      }
    }

    // Animation loop
    function animate() {
      requestAnimationFrame(animate);
      updateBalloons();
      renderer.render(scene, camera);
    }
  </script>
</body>
</html>

